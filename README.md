Решение задач по SQL.
Изучение и практика в SQL.
Каждая задача размещена в отдельном файле.

**************************************************
Задача 1. 
Написать скрипты на языке T-SQL, чтобы получить список кредитов, которые на момент расчета имеют непогашенную задолженность, и рассчитать для каждого такого кредита:
1. Общую (накопленную) сумму просроченного долга непогашенную (не выплаченную) к моменту расчета.
2. Дату начала текущей просрочки. Под датой начала просрочки, в данной задаче понимается первая дата непрерывного периода, в котором общая сумма просроченного непогашенного долга > 0.
3. Кол-во дней текущей просрочки.

Исходные данные
Таблица PDCL – содержит информацию о выносах на просрочку неоплаченных сумм по кредиту и о погашениях просроченного долга. 

Структура
Date
Дата
Customer
Номер клиента
Deal
Номер кредита
Currency
Валюта кредита
Sum
сумма, вынесенная на просрочку ("+") или выплаченная ("-")

Один клиент может иметь несколько кредитов. Если клиент, имеющий кредит, пропускает очередную выплату по графику, у него возникает просрочка. В таблице PDCL при этом появляется соответствующая запись, где Sum – невыплаченная сумма (с положительным знаком). Если, затем, клиент совершает выплату (полную сумму или ее часть)  появляется новая запись, где Sum – выплаченная сумма (со знаком «-»). Следует учесть, что выплата клиента не обязательно полностью гасит накопленный долг, она может составлять лишь часть долга.
В приведенном примере по кредиту 111111 имеется невыплаченный просроченный долг на сумму 6900руб. (12000 + 5000 - 10100), дата начала текущей просрочки 12.12.2009.
*******************************************************

Задача 2:
В таблице хранятся сведения  о еженедельных продажах продукта.
Необходимо настроить автоматическое преобразование еженедельных значений в ежемесячные. Продажи в переходных неделях (часть недели в одном месяце, часть в другом) необходимо распределить по календарным дням.
В данном примере продажи за неделю, окончившуюся 05.03.2013, необходимо распределить следующим образом 2 дня на февраль, 5  дней на март.
Результатом решения задачи является SQL код, который позволит автоматически получать преобразованные данные в формате «Таблица результат». Таблица с данными условно называется Test. Ограничения на использование различных инструментов отсутствуют.
***********************************************************

Задача 3
Необходимо разработать код хранимой процедуры\функции, которая при передаче в нее текущей отчетной даты будет возвращать в табличном режиме значения текущей даты и дат предыдущих 3 недель.
call test ('2013-03-06')--вызов отчетной даты
***********************************************************

Задача 4
Существует представление/view. По сути код view содержит несколько джойнов таблицы самой на себя.
В последнее время запросы на выборку данных из этой view стали работать очень долго, что замедляет скорость обновления отчетов.
Предложить перечень мероприятий по ускорению получения выборок из этой view.
************************************************************

Задача 5:
Есть таблица table1 c 2 столбцами: дата Date1 и значение val1 числовое. 
a. Вывести значения суммы нарастающим итогом с учетом, отсутсвующих дат в table1 начиная с 01.01.2018


